{"ast":null,"code":"import { SystemOrQueuing, TypeCalculate } from '../Constants';\nimport { Division, Factorial, Power } from './../../../utils/MathUtils';\nexport class MMKMMModel {\n  // basic values\n  // results\n  constructor(lambda, miu, k, m, n = 0, horas = 0, espera = 0, sistema = 0, servidor = 0) {\n    this.lambda = void 0;\n    this.miu = void 0;\n    this.m = void 0;\n    this.k = void 0;\n    this.n = void 0;\n    this.horas = void 0;\n    this.espera = void 0;\n    this.sistema = void 0;\n    this.servidor = void 0;\n    this.p0 = 0;\n    this.pe = 0;\n    this.pne = 0;\n    this.pn = 0;\n    this.lq = 0;\n    this.l = 0;\n    this.wq = 0;\n    this.w = 0;\n    this.wn = 0;\n    this.ln = 0;\n    this.costoServidor = 0;\n    this.costoSistema = 0;\n    this.costoCola = 0;\n    this.lambda = lambda;\n    this.miu = miu;\n    this.k = k;\n    this.m = m;\n    this.n = n;\n    this.horas = horas;\n    this.espera = espera;\n    this.sistema = sistema;\n    this.servidor = servidor;\n  }\n\n  isMultichannel() {\n    return this.k > 1;\n  }\n\n  async calculateAll(system = SystemOrQueuing.System, typeCalculate = TypeCalculate.Fixed) {\n    this.p0 = this.getP0();\n    this.pn = this.getPn(system, typeCalculate);\n    this.pe = this.getPe();\n    this.pne = 1 - this.pe;\n    this.l = this.getL();\n    this.lq = this.getLq();\n    this.ln = this.getLn();\n    this.wq = this.getWq();\n    this.w = this.getW();\n    this.wn = this.getWn();\n  } // The probability P0 of finding the empty or idle system\n\n\n  getP0() {\n    // summation\n    let summation1 = this.summation1ForP0();\n    let summation2 = this.summation2ForP0();\n    return Division(1, summation1 + summation2);\n  }\n\n  summation1ForP0() {\n    let value = 0;\n\n    for (let n = 0; n <= parseInt(this.k.toString()) - 1; n++) {\n      // M!\n      let fact = Factorial(this.m); // (M - n)!\n\n      let subItem1 = Factorial(this.m - n); // n!\n\n      let subItem2 = Factorial(n); // (M - n)!n!\n\n      let denominator = subItem1 * subItem2; // M! / (M - n)!n!\n\n      let item1 = Division(fact, denominator); // (lambda/miu)^n\n\n      let div = Division(this.lambda, this.miu);\n      let item2 = Power(div, n);\n      let operation = item1 * item2;\n      value += operation;\n    }\n\n    return value;\n  }\n\n  summation2ForP0() {\n    let value = 0;\n\n    for (let n = this.k; n <= this.m; n++) {\n      // M!\n      let fact = Factorial(this.m); // (M - n)!\n\n      let subItem1 = Factorial(this.m - n); // k!\n\n      let subItem2 = Factorial(this.k); // k^n-k\n\n      let subItem3 = Power(this.k, n - this.k); // (M - n)!k!k^n-k\n\n      let denominator = subItem1 * subItem2 * subItem3; // M! / (M - n)!k!k^n-k\n\n      let item1 = Division(fact, denominator); // (lambda/miu)^n\n\n      let div = Division(this.lambda, this.miu);\n      let item2 = Power(div, n);\n      let operation = item1 * item2;\n      value += operation;\n    }\n\n    return value;\n  } // The probability Pn of finding exactly n customers in the system\n\n\n  getPn(system, typeCalculate) {\n    // Calculate Pn to finding client on System\n    if (system === SystemOrQueuing.System) {\n      // fixed SYSTEM\n      if (typeCalculate === TypeCalculate.Fixed) {\n        return this.basicPn(this.n);\n      } // max SYSTEM\n\n\n      if (typeCalculate === TypeCalculate.Max) {\n        let value = 0;\n\n        for (let i = 0; i <= this.n; i++) {\n          value += this.basicPn(i); // console.log('MAX SYSTEM', value, i);\n        }\n\n        return value;\n      } // at least SYSTEM\n\n\n      if (typeCalculate === TypeCalculate.AtLeast) {\n        let value = 0;\n\n        for (let i = 0; i < this.n; i++) {\n          value += this.basicPn(i);\n        }\n\n        return 1 - value;\n      }\n    } // Calculate Pn to finding client on Queuing\n\n\n    if (system === SystemOrQueuing.Queuing) {\n      // fixed Queuing\n      if (typeCalculate === TypeCalculate.Fixed) {\n        return this.basicPn(this.n + this.k);\n      } // max Queuing\n\n\n      if (typeCalculate === TypeCalculate.Max) {\n        let value = 0;\n        let end = this.n + this.k;\n\n        for (let i = 0; i <= end; i++) {\n          value += this.basicPn(i);\n        }\n\n        return value;\n      } // at least Queuing\n\n\n      if (typeCalculate === TypeCalculate.AtLeast) {\n        let value = 0;\n\n        for (let i = 0; i <= this.n; i++) {\n          value += this.basicPn(i);\n        }\n\n        return 1 - value;\n      }\n    }\n\n    return 0;\n  }\n\n  basicPn(n) {\n    if (0 <= n && n < this.k) {\n      return this.calculatePnWhenNLessK(n);\n    } else {\n      return this.calculatePnWhenNHigherK(n);\n    }\n  }\n\n  calculatePnWhenNLessK(n) {\n    // M!\n    let fact = Factorial(this.m); // (M - n)!\n\n    let subItem1 = Factorial(this.m - n); // n!\n\n    let subItem2 = Factorial(n); // (M - n)!n!\n\n    let denominator = subItem1 * subItem2; // M! / (M - n)!n!\n\n    let item1 = Division(fact, denominator); // (lambda/miu)^n\n\n    let div = Division(this.lambda, this.miu);\n    let item2 = Power(div, n);\n    return this.p0 * item1 * item2;\n  }\n\n  calculatePnWhenNHigherK(n) {\n    // M!\n    let fact = Factorial(this.m); // (M - n)!\n\n    let subItem1 = Factorial(this.m - n); // k!\n\n    let subItem2 = Factorial(this.k); // k^n-k\n\n    let subItem3 = Power(this.k, n - this.k); // (M - n)!k!k^n-k\n\n    let denominator = subItem1 * subItem2 * subItem3; // M! / (M - n)!k!k^n-k\n\n    let item1 = Division(fact, denominator); // (lambda/miu)^n\n\n    let div = Division(this.lambda, this.miu);\n    let item2 = Power(div, n);\n    return this.p0 * item1 * item2;\n  } // The probability Pe of finding the system busy\n\n\n  getPe() {\n    let value = 0;\n\n    for (let n = this.k; n <= this.m; n++) {\n      value += this.basicPn(n);\n    }\n\n    return value;\n  } // The expected number L of clients in the system\n\n\n  getL() {\n    let sum1 = this.summation1ForL();\n    let sum2 = this.summation2ForL();\n    let sum3 = this.summation3ForL();\n    return sum1 + sum2 + sum3;\n  }\n\n  summation1ForL() {\n    let value = 0;\n    let end = this.k - 1;\n\n    for (let n = 0; n <= end; n++) {\n      // n*Pn\n      let operation = n * this.basicPn(n);\n      value += operation;\n    }\n\n    return value;\n  }\n\n  summation2ForL() {\n    let value = 0;\n\n    for (let n = this.k; n <= this.m; n++) {\n      // n - k\n      let item1 = n - this.k; // Pn\n\n      let item2 = this.basicPn(n); // (n - k) *Pn\n\n      let operation = item1 * item2;\n      value += operation;\n    }\n\n    return value;\n  }\n\n  summation3ForL() {\n    let value = 0;\n    let end = this.k - 1;\n\n    for (let n = 0; n <= end; n++) {\n      value += this.basicPn(n);\n    } // 1 - sum(Pn)\n\n\n    let item1 = 1 - value; // k * (1 - sum(Pn))\n\n    return this.k * item1;\n  } // The expected number Lq of clients in the queue\n\n\n  getLq() {\n    let value = 0;\n\n    for (let n = this.k; n <= this.m; n++) {\n      // n - k\n      let item1 = n - this.k; // Pn\n\n      let item2 = this.basicPn(n); // (n - k) * Pn\n\n      let operation = item1 * item2;\n      value += operation;\n    }\n\n    return value;\n  } // The expected number Ln of clients in the non-empty queue\n\n\n  getLn() {\n    return Division(this.lq, this.pe);\n  } // The expected time Wq in the queue by the clients\n\n\n  getWq() {\n    // (M - L) * lambda\n    let denominator = (this.m - this.l) * this.lambda;\n    return Division(this.lq, denominator);\n  } // The expected average time W in the system by the clients\n\n\n  getW() {\n    // 1 / miu\n    let item2 = Division(1, this.miu); // Wq + (1 / miu)\n\n    return this.wq + item2;\n  } // The expected time Wn in the queue for queues not empty by clients\n\n\n  getWn() {\n    return Division(this.wq, this.pe);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/jhonc/Desktop/CALCULADORA/queueing-theory-calculator/src/library/queueing/formulas/MMKMM.model.ts"],"names":["SystemOrQueuing","TypeCalculate","Division","Factorial","Power","MMKMMModel","constructor","lambda","miu","k","m","n","horas","espera","sistema","servidor","p0","pe","pne","pn","lq","l","wq","w","wn","ln","costoServidor","costoSistema","costoCola","isMultichannel","calculateAll","system","System","typeCalculate","Fixed","getP0","getPn","getPe","getL","getLq","getLn","getWq","getW","getWn","summation1","summation1ForP0","summation2","summation2ForP0","value","parseInt","toString","fact","subItem1","subItem2","denominator","item1","div","item2","operation","subItem3","basicPn","Max","i","AtLeast","Queuing","end","calculatePnWhenNLessK","calculatePnWhenNHigherK","sum1","summation1ForL","sum2","summation2ForL","sum3","summation3ForL"],"mappings":"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","sourcesContent":["import { SystemOrQueuing, TypeCalculate } from '../Constants';\r\nimport { Division, Factorial, Power } from './../../../utils/MathUtils';\r\n\r\nexport class MMKMMModel {\r\n  // basic values\r\n  readonly lambda: number;\r\n  readonly miu: number;\r\n  readonly m: number;\r\n  readonly k: number;\r\n  readonly n: number;\r\n  readonly horas: number;\r\n  readonly espera: number;\r\n  readonly sistema: number;\r\n  readonly servidor: number;\r\n\r\n  // results\r\n  p0: number = 0;\r\n  pe: number = 0;\r\n  pne: number = 0;\r\n\r\n  pn: number = 0;\r\n  lq: number = 0;\r\n  l: number = 0;\r\n  wq: number = 0;\r\n  w: number = 0;\r\n  wn: number = 0;\r\n  ln: number = 0;\r\n  costoServidor =0;\r\n  costoSistema =0;\r\n  costoCola =0;\r\n\r\n  constructor(\r\n    lambda: number,\r\n    miu: number,\r\n    k: number,\r\n    m: number,\r\n    n: number = 0,\r\n    horas: number = 0, espera: number = 0, sistema: number = 0, servidor: number = 0\r\n  ) {\r\n    this.lambda = lambda;\r\n    this.miu = miu;\r\n    this.k = k;\r\n    this.m = m;\r\n    this.n = n;\r\n    this.horas = horas;\r\n    this.espera = espera;\r\n    this.sistema = sistema;\r\n    this.servidor = servidor;\r\n  }\r\n\r\n  isMultichannel(): boolean {\r\n    return this.k > 1;\r\n  }\r\n\r\n  async calculateAll(\r\n    system: SystemOrQueuing = SystemOrQueuing.System,\r\n    typeCalculate: TypeCalculate = TypeCalculate.Fixed,\r\n  ): Promise<void> {\r\n    this.p0 = this.getP0();\r\n    this.pn = this.getPn(system, typeCalculate);\r\n    this.pe = this.getPe();\r\n    this.pne = 1 - this.pe;\r\n    this.l = this.getL();\r\n    this.lq = this.getLq();\r\n    this.ln = this.getLn();\r\n    this.wq = this.getWq();\r\n\r\n    this.w = this.getW();\r\n    this.wn = this.getWn();\r\n  }\r\n\r\n  // The probability P0 of finding the empty or idle system\r\n  private getP0(): number {\r\n    // summation\r\n    let summation1 = this.summation1ForP0();\r\n    let summation2 = this.summation2ForP0();\r\n\r\n    return Division(1, summation1 + summation2);\r\n  }\r\n\r\n  private summation1ForP0(): number {\r\n    let value = 0;\r\n    for (let n = 0; n <= parseInt(this.k.toString()) - 1; n++) {\r\n      // M!\r\n      let fact = Factorial(this.m);\r\n      // (M - n)!\r\n      let subItem1 = Factorial(this.m - n);\r\n      // n!\r\n      let subItem2 = Factorial(n);\r\n      // (M - n)!n!\r\n      let denominator = subItem1 * subItem2;\r\n      // M! / (M - n)!n!\r\n      let item1 = Division(fact, denominator);\r\n\r\n      // (lambda/miu)^n\r\n      let div = Division(this.lambda, this.miu);\r\n      let item2 = Power(div, n);\r\n\r\n      let operation = item1 * item2;\r\n      value += operation;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  private summation2ForP0(): number {\r\n    let value = 0;\r\n    for (let n = this.k; n <= this.m; n++) {\r\n      // M!\r\n      let fact = Factorial(this.m);\r\n      // (M - n)!\r\n      let subItem1 = Factorial(this.m - n);\r\n      // k!\r\n      let subItem2 = Factorial(this.k);\r\n      // k^n-k\r\n      let subItem3 = Power(this.k, n - this.k);\r\n      // (M - n)!k!k^n-k\r\n      let denominator = subItem1 * subItem2 * subItem3;\r\n      // M! / (M - n)!k!k^n-k\r\n      let item1 = Division(fact, denominator);\r\n\r\n      // (lambda/miu)^n\r\n      let div = Division(this.lambda, this.miu);\r\n      let item2 = Power(div, n);\r\n\r\n      let operation = item1 * item2;\r\n      value += operation;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  // The probability Pn of finding exactly n customers in the system\r\n  private getPn(system: SystemOrQueuing, typeCalculate: TypeCalculate): number {\r\n    // Calculate Pn to finding client on System\r\n    if (system === SystemOrQueuing.System) {\r\n      // fixed SYSTEM\r\n      if (typeCalculate === TypeCalculate.Fixed) {\r\n        return this.basicPn(this.n);\r\n      }\r\n\r\n      // max SYSTEM\r\n      if (typeCalculate === TypeCalculate.Max) {\r\n        let value = 0;\r\n        for (let i = 0; i <= this.n; i++) {\r\n          value += this.basicPn(i);\r\n          // console.log('MAX SYSTEM', value, i);\r\n        }\r\n        return value;\r\n      }\r\n\r\n      // at least SYSTEM\r\n      if (typeCalculate === TypeCalculate.AtLeast) {\r\n        let value = 0;\r\n        for (let i = 0; i < this.n; i++) {\r\n          value += this.basicPn(i);\r\n        }\r\n        return 1 - value;\r\n      }\r\n    }\r\n    // Calculate Pn to finding client on Queuing\r\n    if (system === SystemOrQueuing.Queuing) {\r\n      // fixed Queuing\r\n      if (typeCalculate === TypeCalculate.Fixed) {\r\n        return this.basicPn(this.n + this.k);\r\n      }\r\n\r\n      // max Queuing\r\n      if (typeCalculate === TypeCalculate.Max) {\r\n        let value = 0;\r\n        let end = this.n + this.k;\r\n        for (let i = 0; i <= end; i++) {\r\n          value += this.basicPn(i);\r\n        }\r\n        return value;\r\n      }\r\n\r\n      // at least Queuing\r\n      if (typeCalculate === TypeCalculate.AtLeast) {\r\n        let value = 0;\r\n        for (let i = 0; i <= this.n; i++) {\r\n          value += this.basicPn(i);\r\n        }\r\n        return 1 - value;\r\n      }\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  private basicPn(n: number): number {\r\n    if (0 <= n && n < this.k) {\r\n      return this.calculatePnWhenNLessK(n);\r\n    } else {\r\n      return this.calculatePnWhenNHigherK(n);\r\n    }\r\n  }\r\n\r\n  private calculatePnWhenNLessK(n: number): number {\r\n    // M!\r\n    let fact = Factorial(this.m);\r\n    // (M - n)!\r\n    let subItem1 = Factorial(this.m - n);\r\n    // n!\r\n    let subItem2 = Factorial(n);\r\n    // (M - n)!n!\r\n    let denominator = subItem1 * subItem2;\r\n    // M! / (M - n)!n!\r\n    let item1 = Division(fact, denominator);\r\n\r\n    // (lambda/miu)^n\r\n    let div = Division(this.lambda, this.miu);\r\n    let item2 = Power(div, n);\r\n\r\n    return this.p0 * item1 * item2;\r\n  }\r\n\r\n  private calculatePnWhenNHigherK(n: number): number {\r\n    // M!\r\n    let fact = Factorial(this.m);\r\n    // (M - n)!\r\n    let subItem1 = Factorial(this.m - n);\r\n    // k!\r\n    let subItem2 = Factorial(this.k);\r\n    // k^n-k\r\n    let subItem3 = Power(this.k, n - this.k);\r\n    // (M - n)!k!k^n-k\r\n    let denominator = subItem1 * subItem2 * subItem3;\r\n    // M! / (M - n)!k!k^n-k\r\n    let item1 = Division(fact, denominator);\r\n\r\n    // (lambda/miu)^n\r\n    let div = Division(this.lambda, this.miu);\r\n    let item2 = Power(div, n);\r\n\r\n    return this.p0 * item1 * item2;\r\n  }\r\n\r\n  // The probability Pe of finding the system busy\r\n  private getPe(): number {\r\n    let value = 0;\r\n    for (let n = this.k; n <= this.m; n++) {\r\n      value += this.basicPn(n);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  // The expected number L of clients in the system\r\n  private getL(): number {\r\n    let sum1 = this.summation1ForL();\r\n    let sum2 = this.summation2ForL();\r\n    let sum3 = this.summation3ForL();\r\n    return sum1 + sum2 + sum3;\r\n  }\r\n\r\n  summation1ForL(): number {\r\n    let value = 0;\r\n    let end = this.k - 1;\r\n    for (let n = 0; n <= end; n++) {\r\n      // n*Pn\r\n      let operation = n * this.basicPn(n);\r\n      value += operation;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  summation2ForL(): number {\r\n    let value = 0;\r\n    for (let n = this.k; n <= this.m; n++) {\r\n      // n - k\r\n      let item1 = n - this.k;\r\n      // Pn\r\n      let item2 = this.basicPn(n);\r\n      // (n - k) *Pn\r\n      let operation = item1 * item2;\r\n      value += operation;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  summation3ForL(): number {\r\n    let value = 0;\r\n    let end = this.k - 1;\r\n    for (let n = 0; n <= end; n++) {\r\n      value += this.basicPn(n);\r\n    }\r\n    // 1 - sum(Pn)\r\n    let item1 = 1 - value;\r\n    // k * (1 - sum(Pn))\r\n    return this.k * item1;\r\n  }\r\n\r\n  // The expected number Lq of clients in the queue\r\n  private getLq(): number {\r\n    let value = 0;\r\n    for (let n = this.k; n <= this.m; n++) {\r\n      // n - k\r\n      let item1 = n - this.k;\r\n      // Pn\r\n      let item2 = this.basicPn(n);\r\n      // (n - k) * Pn\r\n      let operation = item1 * item2;\r\n      value += operation;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  // The expected number Ln of clients in the non-empty queue\r\n  private getLn(): number {\r\n    return Division(this.lq, this.pe);\r\n  }\r\n\r\n  // The expected time Wq in the queue by the clients\r\n  private getWq(): number {\r\n    // (M - L) * lambda\r\n    let denominator = (this.m - this.l) * this.lambda;\r\n    return Division(this.lq, denominator);\r\n  }\r\n\r\n  // The expected average time W in the system by the clients\r\n  private getW(): number {\r\n    // 1 / miu\r\n    let item2 = Division(1, this.miu);\r\n    // Wq + (1 / miu)\r\n    return this.wq + item2;\r\n  }\r\n\r\n  // The expected time Wn in the queue for queues not empty by clients\r\n  private getWn(): number {\r\n    return Division(this.wq, this.pe);\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}